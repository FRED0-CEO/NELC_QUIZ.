<!doctype html>
<html lang="pt-PT">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz NELC ‚Äî Pronomes Pessoais</title>

  <!-- jsPDF + AutoTable -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

  <style>
    :root {
      --bg:#071025; --card:#0b1320; --accent:#06b6d4; --accent-2:#7c3aed;
      --muted:#94a3b8; --success:#16a34a; --danger:#ef4444;
      --radius:12px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto;
      background:linear-gradient(180deg,#041026 0%, #07122a 100%);
      color:#e6eef6; display:flex; align-items:center; justify-content:center;
      padding:20px;
    }
    .container{width:100%;max-width:900px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));
          border-radius:var(--radius);padding:20px;box-shadow:0 8px 30px rgba(2,8,23,0.7);}
    h1{text-align:center;margin-bottom:20px;}
    button{background:var(--accent);color:#021021;border:none;padding:10px 14px;
           border-radius:10px;font-weight:700;cursor:pointer;}
    button:hover{opacity:0.9}
    button.ghost{background:transparent;color:var(--muted);
                 border:1px solid rgba(255,255,255,0.1);}
    .progress{height:12px;background:rgba(255,255,255,0.05);
              border-radius:999px;overflow:hidden;margin:10px 0;}
    .bar{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-2));
         transition:width .5s ease;}
    .option{display:flex;align-items:center;gap:10px;padding:10px;
            border-radius:10px;border:1px solid rgba(255,255,255,0.05);
            margin-bottom:8px;cursor:pointer;transition:all .2s;}
    .option:hover{background:rgba(255,255,255,0.04);}
    .option.correct{background:rgba(16,185,129,0.08);border-color:rgba(16,185,129,0.3);}
    .option.incorrect{background:rgba(239,68,68,0.08);border-color:rgba(239,68,68,0.3);}
    .explain{color:var(--muted);margin-top:8px;display:none;}
    .explain.show{display:block;}
    .controls{display:flex;justify-content:space-between;margin-top:15px;}
    #startScreen{text-align:center;}
    #startScreen input{padding:8px;border-radius:8px;border:none;width:200px;margin-bottom:12px;}
    .result{margin-top:20px;padding:15px;border-radius:10px;}
    .ok{background:rgba(16,185,129,0.1);color:var(--success);}
    .bad{background:rgba(239,68,68,0.1);color:var(--danger);}
    footer{text-align:center;color:var(--muted);margin-top:20px;font-size:13px;}
  </style>
</head>
<body>
<div class="container">

  <!-- Tela Inicial -->
  <div id="startScreen" class="card">
    <h1>Quiz NELC ‚Äî Pronomes Pessoais</h1>
    <p>Insere o teu nome para come√ßar:</p>
    <input type="text" id="playerNameInput" placeholder="Teu nome completo" />
    <br>
    <button id="startBtn">Iniciar Quiz</button>
  </div>

  <!-- Tela do Quiz -->
  <div id="quizScreen" class="card" style="display:none;">
    <div>
      <strong id="qCounter">Pergunta 1 / 15</strong>
      <span style="float:right;">‚è±Ô∏è <span id="timeDisplay">00:00</span></span>
    </div>
    <div class="progress"><div class="bar" id="progressBar"></div></div>
    <div id="questionArea"></div>

    <div class="controls">
      <button id="prevBtn" class="ghost">‚óÄ Anterior</button>
      <button id="nextBtn">Seguinte ‚ñ∂</button>
    </div>

    <div id="resultBox" style="display:none;" class="result"></div>
  </div>

  <footer>Powered by NELC ‚Äî Ingl√™s que conecta Mo√ßambique ao mundo üåç</footer>
</div>

<script>
let playerName='';
let current=0, score=0, timer=0, timerInterval=null;
const QUESTIONS=[
  {q:"O que s√£o pronomes pessoais?",a:["Palavras que substituem nomes e indicam quem realiza ou recebe a a√ß√£o","Palavras que descrevem lugares","Palavras que indicam tempo","Palavras que unem frases"],correct:0,explain:"Pronomes pessoais substituem nomes (I, you, he...)."},
  {q:"Qual destes √© um pronome pessoal do caso reto (sujeito)?",a:["Me","Him","They","Us"],correct:2,explain:"They √© sujeito (caso reto)."},
  {q:"Qual √© o pronome objeto de 'we'?",a:["our","us","they","them"],correct:1,explain:"Pronome objeto de 'we' √© 'us'."},
  {q:"Qual par est√° correto (reto ‚Üí objeto)?",a:["I ‚Üí me","He ‚Üí her","We ‚Üí they","They ‚Üí she"],correct:0,explain:"I ‚Üí me √© par correto."},
  {q:"Qual pronome reflexivo corresponde a 'she'?",a:["Herself","Himself","Yourself","Ourselves"],correct:0,explain:"Pronome reflexivo de 'she' √© 'herself'."},
  {q:"Em 'She gave the book to me', 'me' √©:",a:["Pronome sujeito","Pronome objeto","Pronome reflexivo","Adjetivo"],correct:1,explain:"'Me' atua como pronome objeto."},
  {q:"Qual frase est√° correta?",a:["I is a student.","I am a student.","I are a student.","I be a student."],correct:1,explain:"Correto: 'I am a student.'"},
  {q:"Forma negativa de 'They are':",a:["They not are","They aren't","They is not","They be not"],correct:1,explain:"Forma negativa: 'They aren't'."},
  {q:"Pergunta correta com 'you' e verbo to be:",a:["You are?","Are you?","Is you?","Do you are?"],correct:1,explain:"Forma interrogativa: 'Are you?'."},
  {q:"Passado de 'I am':",a:["I were","I was","I be","I are"],correct:1,explain:"Passado: 'I was'."},
  {q:"Uso correto de 'it' para objetos:",a:["It is broken.","It are broken.","They is broken.","He are broken."],correct:0,explain:"'It is broken' √© correto."},
  {q:"Qual N√ÉO √© pronome do caso reto?",a:["He","She","Her","They"],correct:2,explain:"'Her' √© pronome objeto."},
  {q:"Como se diz 'eu mesmo' em ingl√™s?",a:["Himself","Yourself","Myself","Ourselves"],correct:2,explain:"'Myself' = eu mesmo."},
  {q:"Pergunta correta no passado com 'she':",a:["Were she?","Was she?","Is she?","Did she be?"],correct:1,explain:"Pergunta correta: 'Was she?'."},
  {q:"Completa: 'We ___ teachers.'",a:["is","are","am","be"],correct:1,explain:"Correto: 'We are teachers.'"}
];

const startScreen=document.getElementById('startScreen');
const quizScreen=document.getElementById('quizScreen');
const questionArea=document.getElementById('questionArea');
const qCounter=document.getElementById('qCounter');
const progressBar=document.getElementById('progressBar');
const timeDisplay=document.getElementById('timeDisplay');
const resultBox=document.getElementById('resultBox');
const prevBtn=document.getElementById('prevBtn');
const nextBtn=document.getElementById('nextBtn');

let userAnswers=Array(QUESTIONS.length).fill(null);

function formatTime(s){const m=Math.floor(s/60).toString().padStart(2,'0');const sec=(s%60).toString().padStart(2,'0');return `${m}:${sec}`;}

function startTimer(){
  timeDisplay.textContent=formatTime(timer);
  timerInterval=setInterval(()=>{timer++;timeDisplay.textContent=formatTime(timer);},1000);
}

function renderQuestion(){
  const q=QUESTIONS[current];
  questionArea.innerHTML=`<h3>${q.q}</h3>`;
  q.a.forEach((opt,i)=>{
    const div=document.createElement('div');
    div.className='option';
    div.textContent=opt;
    div.addEventListener('click',()=>selectAnswer(i,div));
    if(userAnswers[current]!==null){
      if(i===q.correct) div.classList.add('correct');
      else if(i===userAnswers[current]) div.classList.add('incorrect');
    }
    questionArea.appendChild(div);
  });
  const explain=document.createElement('div');
  explain.className='explain';
  questionArea.appendChild(explain);
  qCounter.textContent=`Pergunta ${current+1} / ${QUESTIONS.length}`;
  progressBar.style.width=`${(current/QUESTIONS.length)*100}%`;
  prevBtn.disabled=current===0;
  nextBtn.disabled=current===QUESTIONS.length-1;
}

function selectAnswer(idx,el){
  if(userAnswers[current]!==null) return;
  const q=QUESTIONS[current];
  userAnswers[current]=idx;
  const all=document.querySelectorAll('.option');
  all.forEach((opt,i)=>{
    if(i===q.correct) opt.classList.add('correct');
    else if(i===idx) opt.classList.add('incorrect');
  });
  const explain=document.querySelector('.explain');
  explain.textContent=q.explain;
  explain.classList.add('show');
  if(idx===q.correct) score++;
  setTimeout(()=>{if(current<QUESTIONS.length-1){current++;renderQuestion();}else{showResult();}},900);
}

function showResult(){
  clearInterval(timerInterval);
  const total=QUESTIONS.length;
  const pct=Math.round((score/total)*100);
  const msg=pct>=70?"Parab√©ns!":"Tenta novamente!";
  resultBox.style.display='block';
  resultBox.className=`result ${pct>=70?'ok':'bad'}`;
  resultBox.innerHTML=`<strong>${playerName}, obtiveste ${score}/${total} (${pct}%)</strong><br>${msg}<br><br><button id="pdfBtn">Gerar PDF do Resultado</button>`;
  document.getElementById('pdfBtn').addEventListener('click',generatePDF);
}

function generatePDF(){
  const { jsPDF } = window.jspdf;
  const doc=new jsPDF({unit:'pt',format:'a4'});
  doc.setFont('Times','Normal');
  doc.setFontSize(12);
  doc.text('Quiz NELC ‚Äî Pronomes Pessoais (Personal Pronouns)',40,40);
  doc.text(`Participante: ${playerName}`,40,60);
  doc.text(`Pontua√ß√£o: ${score}/${QUESTIONS.length}`,40,80);
  doc.text(`Tempo: ${formatTime(timer)}`,40,100);
  doc.text(`Data: ${new Date().toLocaleString()}`,40,120);

  const head=[['#','Pergunta','Tua resposta','Correta']];
  const body=QUESTIONS.map((q,i)=>[
    (i+1).toString(),
    q.q,
    userAnswers[i]===null?'‚Äî':q.a[userAnswers[i]],
    q.a[q.correct]
  ]);

  doc.autoTable({
    startY:140,
    head:head,
    body:body,
    styles:{font:'Times',fontSize:12,cellPadding:4},
    headStyles:{fillColor:[28,79,102]}
  });

  const y=doc.lastAutoTable.finalY+20;
  doc.text('Espa√ßo para Observa√ß√µes / Respostas:',40,y);
  doc.rect(40,y+10,520,80);
  doc.setFontSize(10);
  doc.text('Powered by NELC ‚Äî Ingl√™s que conecta Mo√ßambique ao mundo üåç',40,820);
  doc.save(`Resultado_${playerName.replace(/\s+/g,'_')}.pdf`);
}

prevBtn.addEventListener('click',()=>{if(current>0){current--;renderQuestion();}});
nextBtn.addEventListener('click',()=>{if(current<QUESTIONS.length-1){current++;renderQuestion();}});
document.getElementById('startBtn').addEventListener('click',()=>{
  const input=document.getElementById('playerNameInput');
  if(!input.value.trim()){alert('Por favor, digita o teu nome.');return;}
  playerName=input.value.trim();
  startScreen.style.display='none';
  quizScreen.style.display='block';
  renderQuestion();
  startTimer();
});
</script>
</body>
</html>
